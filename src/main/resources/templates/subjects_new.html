<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enroll New Subject</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        body {
             margin: 0;
             padding: 0;
         }

         /* Sidebar - Desktop */
         .sidebar {
             height: 100vh;
             background-color: #004480;
             color: white;
             padding: 20px 15px;
             position: fixed;
             left: 0;
             top: 0;
             z-index: 1000;
             width: 200px;
             overflow-y: auto;
         }

         .sidebar h5 {
             color: white;
             margin-bottom: 1.5rem;
             font-size: 1.1rem;
         }

         .sidebar .nav {
             flex-direction: column;
             display: flex;
         }

         .sidebar .nav-link {
             color: #adb5bd;
             padding: 0.75rem 1rem;
             border-radius: 0.25rem;
             transition: all 0.3s;
         }

         .sidebar .nav-link:hover,
         .sidebar .nav-link.active {
             background-color: #495057;
             color: white;
         }

         .logout-button {
             background-color: #dc3545;
             border: 1px solid #dc3545;
             color: white;
             padding: 0.75rem 1rem;
             margin-top: 1rem;
             width: 100%;
             text-align: center;
             border-radius: 0.25rem;
             cursor: pointer;
             transition: all 0.3s;
         }

         .logout-button:hover {
             background-color: #c82333;
             border-color: #bd2130;
         }

         /* Main content - Desktop */
         .main-content {
             margin-left: 200px;
             padding: 20px;
             min-height: 100vh;
             width: calc(100% - 200px);
         }

         /* Cards */
         .card {
             border-radius: 0.5rem;
             border: none;
         }

         .card-body h5 {
             font-size: 0.9rem;
             margin-bottom: 0.5rem;
         }

         /* Table */
         .table-responsive {
             margin-top: 1rem;
         }

         /* Chart */
         #gradesChart {
             max-height: 300px;
             margin-top: 1rem;
         }

         .text-danger {
             font-size: 0.875em;
         }

         .form-row > [class*="col-"] {
             padding-right: 15px;
             padding-left: 15px;
         }

         /* Mobile Styles - Horizontal navbar always */
         @media (max-width: 768px) {
             /* Make sidebar compact and horizontal */
             .sidebar {
                 position: relative;
                 height: auto;
                 width: 100%;
                 padding: 8px;
             }

             .sidebar h5 {
                 display: none; /* Hide title on mobile to save space */
             }

             /* Horizontal scrollable menu - always in one line */
             .sidebar .nav {
                 flex-direction: row;
                 flex-wrap: nowrap;
                 overflow-x: auto;
                 -webkit-overflow-scrolling: touch;
                 padding: 5px 0;
                 gap: 5px;
                 margin-bottom: 8px;
                 scrollbar-width: thin;
             }

             /* Hide scrollbar for cleaner look */
             .sidebar .nav::-webkit-scrollbar {
                 height: 4px;
             }

             .sidebar .nav::-webkit-scrollbar-track {
                 background: #495057;
             }

             .sidebar .nav::-webkit-scrollbar-thumb {
                 background: #6c757d;
                 border-radius: 2px;
             }

             .sidebar .nav-item {
                 flex: 0 0 auto;
             }

             .sidebar .nav-link {
                 padding: 0.5rem 1rem;
                 font-size: 0.8rem;
                 white-space: nowrap;
             }

             /* Logout button inline with nav items */
             .sidebar form {
                 display: inline-block;
                 margin: 0;
             }

             .logout-button {
                 padding: 0.5rem 1rem;
                 font-size: 0.8rem;
                 margin: 0;
                 white-space: nowrap;
                 width: auto;
             }

             .main-content {
                 margin-left: 0;
                 padding: 15px;
                 width: 100%;
             }

             .main-content h1 {
                 font-size: 1.25rem;
             }

             .main-content h2 {
                 font-size: 1.1rem;
                 margin-top: 1rem;
             }

             .card-body .h1 {
                 font-size: 2rem;
             }

             .border-bottom {
                 padding-top: 0.5rem !important;
                 padding-bottom: 0.5rem !important;
                 margin-bottom: 1rem !important;
             }
         }

         /* Extra small screens - still horizontal */
         @media (max-width: 576px) {
             .sidebar .nav-link {
                 padding: 0.4rem 0.8rem;
                 font-size: 0.75rem;
             }

             .logout-button {
                 font-size: 0.75rem;
                 padding: 0.4rem 0.8rem;
             }

             .main-content h1 {
                 font-size: 1.1rem;
             }

             .card-body h5 {
                 font-size: 0.8rem;
             }

             .card-body .h1 {
                 font-size: 1.5rem;
             }
         }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">

        <nav class="sidebar">
            <h5>Grade Manager</h5>
            <div style="display: flex; align-items: center; width: 100%;">
                <ul class="nav" style="margin-bottom: 0;">
                    <li class="nav-item"><a class="nav-link text-white" th:href="@{/main}">Home</a></li>
                    <li class="nav-item"><a class="nav-link text-white" th:href="@{/dashboard}">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link active  text-white" th:href="@{/subjects}">Subject List</a></li>
                    <li class="nav-item"><a class="nav-link text-white" th:href="@{/students}">Student Directory</a></li>
                    <li class="nav-item"><a class="nav-link text-white" th:href="@{/reports}">Analytics & Reports</a></li>
                    <li class="nav-item"><a class="nav-link text-white" th:href="@{/teachers}">Teachers</a></li>
                    <li class="nav-item">
                        <form th:action="@{/logout}" method="post" style="margin: 0;">
                            <button type="submit" class="logout-button">Logout</button>
                        </form>
                    </li>
                </ul>
            </div>
        </nav>

        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4 main-content">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Enroll New Subject</h1>
            </div>

            <div th:if="${successMessage}" class="alert alert-success" role="alert" th:text="${successMessage}">
                Subject saved successfully!
            </div>
            <div th:if="${errorMessage}" class="alert alert-danger" role="alert" th:text="${errorMessage}">
                Error saving subject. Please check inputs.
            </div>

            <form th:action="@{/subjects}" th:object="${subject}" method="post">

                <input type="hidden" th:field="*{id}">

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="name">Subject Name</label>
                        <input type="text"
                               class="form-control"
                               id="name"
                               th:field="*{name}"
                               placeholder="e.g., Data Structures and Algorithms"
                               required>
                        <div class="text-danger" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name Error</div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-3">
                        <label for="code">Course Code</label>
                        <input type="text"
                               class="form-control"
                               id="code"
                               th:field="*{code}"
                               placeholder="e.g., CS201"
                               required>
                        <div class="text-danger" th:if="${#fields.hasErrors('code')}" th:errors="*{code}">Code Error</div>
                    </div>

                    <div class="form-group col-md-3">
                        <label for="credits">Credits</label>
                        <input type="number"
                               class="form-control"
                               id="credits"
                               th:field="*{credits}"
                               min="1"
                               required>
                        <div class="text-danger" th:if="${#fields.hasErrors('credits')}" th:errors="*{credits}">Credits Error</div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="teachers">Instructor(s)</label>
                        <select id="teachers"
                                th:field="*{teachers}"
                                class="form-control"
                                required multiple>
                            <option th:each="instructor : ${availableInstructors}"
                                    th:value="${instructor.id}"
                                    th:text="${instructor.name + ' ' + instructor.lastName}">Dr. Alice Smith</option>
                        </select>
                        <div class="text-danger" th:if="${#fields.hasErrors('teachers')}" th:errors="*{teachers}">Instructor Error</div>
                        <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple instructors.</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="description">Description</label>
                        <textarea class="form-control"
                                  id="description"
                                  th:field="*{description}"
                                  rows="3"></textarea>
                        <div class="text-danger" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">Description Error</div>
                    </div>
                </div>

                <div class="col-md-12 mt-4">
                    <button type="submit" class="btn btn-primary mr-2">Save Subject</button>
                    <a th:href="@{/subjects}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>

        </main>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>